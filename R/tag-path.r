#' Automatically add the path as an Rd comment.
#'
#' @usage None: this is added automatically.
setClass("PathTag", contains = "Tag",
  list(path = "character"))

setMethod("format", "PathTag", function(x, ...) x@path %||% x@text)

setMethod("defaultTag", c("PathTag", "Object"), function(tag, object) {
  if (isNull(object)) return()
  new("PathTag", path = location(object@srcref))
})

setMethod("writeRd", "PathTag", function(object) {
  paths <- str_c(object@path, collapse = ", ")
  comment <- paste("Generated by roxygen from [", paths, "]", sep = "")
  new_command("comment", comment)
})
